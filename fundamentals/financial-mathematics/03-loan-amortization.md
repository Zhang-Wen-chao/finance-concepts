# 等额本息与贷款摊还 (Loan Amortization)

> 通过年金工具拆解每期还款中的“本金+利息”，看明白贷款成本。

## 学习目标

- 理解等额本息、等额本金等常见贷款还款方式的原理。
- 能够使用年金公式计算每期还款额。
- 学会制作摊还表：区分每期利息、本金、剩余余额。
- 认识提前还款、有效利率等概念对贷款成本的影响。

## 等额本息还款简介

- 贷款金额：`L`
- 期利率：`r`（若年利率 4%，按月还则 `r = 0.04 / 12`）
- 期数：`n`

每期等额还款额：

```math
C = L \times \frac{r}{1 - (1 + r)^{-n}}
```

这是普通年金现值公式的变形。

每期利息 = 上期未还本金 × `r`；
每期本金 = 本期还款额 - 当期利息；
剩余本金 = 上期余额 - 本期本金。

## 摊还表示例

贷款 100,000，年利率 6%，按月等额偿还 3 年（36 期）。

每月利率 `r = 0.06 / 12 = 0.005`，期数 36。

还款额：

```
C = 100,000 × 0.005 / (1 - (1 + 0.005)^-36) ≈ 3,042.13
```

前 3 期摊还表：

| 期数 | 期初本金 | 利息 | 本金 | 期末余额 |
| --- | --- | --- | --- | --- |
| 1 | 100,000.00 | 500.00 | 2,542.13 | 97,457.87 |
| 2 | 97,457.87 | 487.29 | 2,554.84 | 94,903.03 |
| 3 | 94,903.03 | 474.52 | 2,567.61 | 92,335.42 |

可以看到：利息逐期下降，本金偿还逐步上升。

## Excel 与 Python

- Excel：
  - `PMT(rate, nper, pv, fv, type)` 计算等额还款额。
  - `IPMT(rate, per, nper, pv)` 计算第 `per` 期利息。
  - `PPMT(rate, per, nper, pv)` 计算第 `per` 期本金。
  - `CUMIPMT`, `CUMPRINC` 汇总一定期数的利息/本金。
- Python `numpy_financial`：`pmt`, `ipmt`, `ppmt` 等函数。

示例（Python）：

```python
import numpy_financial as nf

r = 0.06 / 12
n = 36
loan = 100000
payment = -nf.pmt(r, n, loan)

period = 1
interest = -nf.ipmt(r, period, n, loan)
principal = -nf.ppmt(r, period, n, loan)
```

## 等额本金对比

等额本金：每期偿还相同金额的本金 `L / n`，利息随余额递减。

每期利息 = 剩余本金 × `r`；每期还款 = 固定本金 + 当期利息。

特点：
- 前期还款压力大，后期逐渐减轻。
- 总利息支出少于等额本息。

## 提前还款与有效利率

- 提前还款会打乱原摊还计划，应计算剩余本金、违约金、节省利息。
- 有效利率考虑了手续费、保险、返还等因素，比名义利率更能反映真实贷款成本。
- 完整成本计算可使用 IRR/ XIRR，将现金流（放款为正、每期还款为负）计算内部收益率。

## 快速自测

1. 贷款 200,000，年利率 5%，按月等额偿还 25 年。求每月还款额，并估算总利息支出。
2. 对比等额本息与等额本金，哪个总利息更低？为什么？
3. 某贷款需一次性支付手续费 2,000，借款金额 50,000，年利率 8%，按月等额还 12 期。如何估算实际年化成本？

### 参考答案与解析

1. `r = 0.05/12`，`n = 300`。还款额约 `1,169.18`；总还款 `≈ 350,754`，总利息 `≈ 150,754`。
2. 等额本金利息更低，因为本金下降更快，从而节省后续利息。
3. 将手续费视作贷款现金流的一部分，使用 Excel `IRR` 或 `XIRR` 计算内部收益率，再年化。实际成本会高于 8%。

## 延伸阅读

- CFA Quantitative Methods：Loan Amortization
- Excel 帮助：`PMT`, `IPMT`, `PPMT`
- 银行贷款合同、住房按揭的摊还计划
- Investopedia：Amortization Schedule

---

下一步可继续 `04-interest-rates.md`，探讨利率换算、实际收益率与对数收益。
