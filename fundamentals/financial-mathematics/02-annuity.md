# 年金与永续年金 (Annuity & Perpetuity)

> 处理“每期等额、连续发生”的现金流，是金融计算最常见的场景。

## 学习目标

- 掌握普通年金、预付年金、永续年金的现值/终值公式。
- 能够区分不同的年金类型，并转换到统一的时间点进行计算。
- 学会等额本息贷款中的年金应用。
- 熟悉常见年金的 Excel 函数与计算器操作。

## 年金分类

- **普通年金 (Ordinary Annuity)**：每期等额现金 **期末** 支付/收取（例：按月还贷）。
- **预付年金 (Annuity Due)**：每期等额现金 **期初** 支付/收取（例：租金先付）。
- **永续年金 (Perpetuity)**：无限期等额现金流（例：某些优先股股息）。

## 普通年金公式

**终值 (FV)**

```math
FV_{OA} = C \times \frac{(1 + r)^n - 1}{r}
```

**现值 (PV)**

```math
PV_{OA} = C \times \frac{1 - (1 + r)^{-n}}{r}
```

其中 `C` 为每期现金流，`r` 为期利率，`n` 为期数。

## 预付年金公式

预付年金可视为普通年金提前 1 期，因此乘以 `(1 + r)`：

```math
FV_{AD} = FV_{OA} \times (1 + r)
```

```math
PV_{AD} = PV_{OA} \times (1 + r)
```

## 永续年金

- 现值公式：

```math
PV_{Perpetuity} = \frac{C}{r}
```

- 若未来现金流从第 `t` 期开始，可先折现到第 `t-1` 期再继续折现到现值。

永续增长模型（于第 1 期开始，增长率 `g < r`）：

```math
PV = \frac{C_1}{r - g}
```

## 等额本息贷款示例

贷款 `L`，利率 `r`，期数 `n`，每期还款额 `C` 可由年金公式得出：

```math
L = C \times \frac{1 - (1 + r)^{-n}}{r}

\Rightarrow C = L \times \frac{r}{1 - (1 + r)^{-n}}
```

## Excel 函数

- `PMT(rate, nper, pv, fv, type)`：求等额支付额（`type = 0` 期末，`type = 1` 期初）。
- `PV(rate, nper, pmt, fv, type)`：求现值。
- `FV(rate, nper, pmt, pv, type)`：求终值。
- `RATE`, `NPER` 可求解未知利率与期数。

## 计算示例

1. **普通年金终值**：每年存 10,000 元，年利率 5%，连续 5 年，终值：
   ```
   FV = 10,000 × ((1 + 0.05)^5 - 1) / 0.05 ≈ 55,256
   ```
2. **预付年金现值**：租金每年 8,000，预付 4 年，利率 6%
   ```
   PV_{OA} = 8,000 × (1 - (1 + 0.06)^-4) / 0.06 ≈ 28,274
   PV_{AD} = PV_{OA} × 1.06 ≈ 29,970
   ```
3. **永续年金**：企业承诺每年支付 5,000，贴现率 7%，现值：
   ```
   PV = 5,000 / 0.07 ≈ 71,429
   ```
4. **等额本息贷款**：贷款 300,000，年利率 4%，按月等额偿还 20 年（240 期）
   ```
   C = 300,000 × (0.04/12) / (1 - (1 + 0.04/12)^-240) ≈ 1,817.94
   ```

## 快速自测

1. 某产品需要客户每年期末支付 5,000 元，持续 6 年，贴现率 6%。现值多少？若改为期初支付，又是多少？
2. 未来三年每年初支付 12,000 元租金，年利率 5%。用普通年金公式如何转换？
3. 某永续增长年金首年支付 2,000，之后每年增长 2%，贴现率 6%。现值是多少？

### 参考答案与解析

1. PV(OA) ≈ `5,000 × (1 - (1 + 0.06)^-6) / 0.06 ≈ 24,933`；预付 PV ≈ 24,933 × 1.06 ≈ 26,429。
2. 先计算普通年金再乘 `(1 + r)`：`PV = 12,000 × (1 - (1 + 0.05)^-3) / 0.05 × 1.05 ≈ 33,153`。
3. `PV = 2,000 / (0.06 - 0.02) = 50,000`。

## 延伸阅读

- CFA 一级 Quantitative Methods：Annuities and Perpetuities
- Excel 函数参考：`PMT`, `PV`, `FV`
- 《公司理财》(Brealey & Myers) 时间价值章节
- Investopedia：Annuity Basics

---

继续学习 `03-loan-amortization.md`，深入等额本息贷款的摊还表和利息本金拆分。
