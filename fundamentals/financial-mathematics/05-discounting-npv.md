# 贴现曲线与净现值 (Discounting & NPV)

> 将未来一串现金流折现到今天，衡量项目/投资是否值得。

## 学习目标

- 理解贴现因子 (Discount Factor)、零息利率、收益率曲线的概念。
- 掌握净现值 (Net Present Value, NPV) 与内部收益率 (Internal Rate of Return, IRR) 的计算。
- 能够比较不同项目或投资的 NPV，并理解 IRR 的优缺点。
- 了解贴现曲线在债券、项目评估中的应用。

## 贴现因子与利率

- 对于期数为 `t` 的现金流，其贴现因子 `DF_t = 1 / (1 + r_t)^t`。
- 若使用连续复利：`DF_t = e^{-r_t \times t}`。
- 零息利率 (Zero Rate or Spot Rate)：直接用于某一到期时间现金流的贴现，收益率曲线就是 `t -> r_t` 的函数。

## 净现值 (NPV)

```
NPV = \sum_{t=0}^{T} \frac{C_t}{(1 + r_t)^t}
```

- `C_0` 为初始投入（通常为负值）。
- `r_t` 可选用统一贴现率，也可以使用不同期限的零息利率。
- NPV > 0：项目增加价值；NPV < 0：项目减少价值。

## 内部收益率 (IRR)

- IRR 定义为使 NPV = 0 的贴现率 `IRR`：

```math
0 = \sum_{t=0}^{T} \frac{C_t}{(1 + IRR)^t}
```

- IRR 是项目的“自带收益率”，可与目标收益率比较。
- 注意：
  - 多次符号变化的现金流可能有多个 IRR（或没有）。
  - IRR 忽略了资金规模差异，需结合 NPV 判断。

## 示例：项目评估

项目投资 -100,000 元，未来三年现金流：40,000、45,000、50,000。贴现率 8%。

```
NPV = -100,000 + 40,000/(1.08)^1 + 45,000/(1.08)^2 + 50,000/(1.08)^3 ≈ 12,285
```

NPV > 0，项目可接受。可用 Excel `=IRR(range)` 计算 IRR，约 13.3%。

## 不同贴现率

- 若使用收益率曲线（不同期限不同利率），应使用对应贴现因子：
  - 1 年零息率 5%，2 年 6%，3 年 6.5%。
  - 各年现金流分别除以 `(1 + 0.05)^1`, `(1 + 0.06)^2`, `(1 + 0.065)^3`。
- 在债券定价、利率互换中常用此方法。

## Excel / Python

- Excel：`NPV(rate, cashflows)`（假定首期在一期后）、`XNPV(rate, cashflows, dates)`（不等间隔）、`IRR`, `XIRR`, `MIRR`。
- Python：NumPy `npf.npv`, `npf.irr`（在 numpy-financial 包中）。

示例：

```python
import numpy_financial as nf
cashflows = [-100000, 40000, 45000, 50000]
npv = nf.npv(0.08, cashflows)
irr = nf.irr(cashflows)
```

## 快速自测

1. 项目现金流：`[-50,000, 20,000, 25,000, 15,000]`，贴现率 7%。NPV 多少？是否接受？
2. 若 IRR = 12%，而要求收益率 10%，应如何决策？若改为 14%，又如何？
3. 为什么多个 IRR 会造成困扰？举例说明何时更适合使用 MIRR 或直接比较 NPV。

### 参考答案与解析

1. NPV ≈ `-50,000 + 20,000/1.07 + 25,000/1.07^2 + 15,000/1.07^3 ≈ 2,329`，为正 → 接受。
2. IRR > 要求收益率 → 接受；若要求收益率 14%（高于 IRR），则拒绝。
3. 现金流多次由负转正时可能有多个 IRR；此时 MIRR（考虑再投资率）或直接比较 NPV 更可靠。

## 延伸阅读

- CFA Quantitative Methods：NPV, IRR, and Other Investment Criteria
- Excel 函数：`NPV`, `XNPV`, `IRR`, `XIRR`, `MIRR`
- 《公司理财》项目评估章节
- Fabozzi《固定收益》：贴现曲线与债券定价

---

至此，金融数学基础的核心主题均已覆盖。可以结合真实项目或债券数据进行实践，或转向下一个模块（如统计学）继续深化。
